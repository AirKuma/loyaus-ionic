<!--
  Generated template for the MessageChat page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-buttons start>
      <button ion-button (click)="dismiss()" color="dark"><ion-icon name="close"></ion-icon></button>
    </ion-buttons>
    <ion-title>{{ lastname }} {{ firstname }}</ion-title>
  </ion-navbar>

</ion-header>


<ion-content>

<!--<ion-refresher (ionRefresh)="doInfinite($event)">
    <ion-refresher-content
            refreshingSpinner="bubbles"
            refreshingText="Loading more data...">
    </ion-refresher-content>
  </ion-refresher>-->

<div class="spinner"><ion-spinner name="crescent" class="itemspinner" *ngIf="spinner==1"></ion-spinner></div>

<div class="message-wrapper" id="chat-autoscroll" style="height: 100%; overflow: scroll" on-scroll="ToTop()">
  <div *ngFor="let message of messagedatas">
			<ion-item no-lines *ngIf="message.user.data[0].id!=auth_user">

        <img src="{{ root }}images/default/male.png" *ngIf="!message.user.data[0].facebook  && message.user.data[0].gender==1"  alt="User Avatar" class="img-circle profile-pic left">
        <img src="{{ root }}images/default/female.png" *ngIf="!message.user.data[0].facebook  && message.user.data[0].gender==0" alt="User Avatar" class="img-circle profile-pic left">
        <img [src]="message.user.data[0].facebook.avatar" *ngIf="message.user.data[0].facebook" alt="User Avatar" class="img-circle profile-pic left">

				<div class="chat-bubble left">
          
					<div class="message white-space-pre-line">
            {{ message.body }}
					</div>

					<div class="message-detail">
						<span class="date">{{ message.created_at }}</span>
					</div>

				</div>
			</ion-item>

			<ion-item no-lines *ngIf="message.user.data[0].id==auth_user">
        <div class="picpullright">
          <div class="chat-bubble right">
            <!--<img class="profile-pic right" src="5" />-->
            
            <div class="message white-space-pre-line">
              {{ message.body }}
            </div>

            <div class="message-detail">
              <span class="date">{{ message.created_at }}</span>
            </div>

          </div>

          <img src="{{ root }}images/default/male.png" *ngIf="!message.user.data[0].facebook  && message.user.data[0].gender==1"  alt="User Avatar" class="img-circle profile-pic right">
          <img src="{{ root }}images/default/female.png" *ngIf="!message.user.data[0].facebook  && message.user.data[0].gender==0" alt="User Avatar" class="img-circle profile-pic right">
          <img [src]="message.user.data[0].facebook.avatar" *ngIf="message.user.data[0].facebook" alt="User Avatar" class="img-circle profile-pic right">
        </div>
			</ion-item>

			<div class="cf"></div>
  </div>
</div>

</ion-content>

<ion-footer>
  <ion-toolbar position="bottom">
      <ion-textarea [(ngModel)]="body" placeholder="輸入訊息..." start></ion-textarea>
      <ion-buttons end>
        <button ion-button (click)="createMessage()" color="dark" [disabled]="sandbutton==0">
          <ion-icon name="send"></ion-icon>
        </button>
      </ion-buttons>
  </ion-toolbar>
</ion-footer>
