<!--
  Generated template for the EditProfile page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>編輯個人檔案</ion-title>
    <ion-buttons ion-button end>
      <button ion-button color="dark" (click)="editProfile(editProfileForm)" [disabled]="!editProfileForm.controls.lastname.valid || !editProfileForm.controls.firstname.valid || !editProfileForm.controls.major_id.valid || !editProfileForm.controls.birthday.valid || !editProfileForm.controls.username.valid || !editProfileForm.controls.other_email.valid || sandbutton==0">
        <ion-icon name="checkmark"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>

</ion-header>


  <ion-content>
  
<div class="spinner"><ion-spinner name="crescent" class="itemspinner" *ngIf="!userdata"></ion-spinner></div>

  <div *ngIf="userdata">

  <form [formGroup]="editProfileForm" (ngSubmit)="editProfile(editProfileForm)" novalidate>

    <ion-list>
    <ion-list-header>基本資訊</ion-list-header>
        <ion-item>
            <ion-label primary>姓氏</ion-label>
            <ion-input type="text" formControlName="lastname" name="lastname"></ion-input>
        </ion-item>

        <div *ngIf="editProfileForm.controls.lastname.hasError('required') && editProfileForm.controls.lastname.touched">
          <font color="red" padding-left>請輸入你的姓氏</font>
        </div>

        <div *ngIf="editProfileForm.controls.lastname.hasError('maxlength') && editProfileForm.controls.lastname.touched">
          <font color="red" padding-left>姓氏至多10個字</font>
        </div>

         <ion-item>
            <ion-label primary>姓名</ion-label>
            <ion-input type="text" formControlName="firstname" name="firstname"></ion-input>
        </ion-item>

        <div *ngIf="editProfileForm.controls.firstname.hasError('required') && editProfileForm.controls.firstname.touched">
          <font color="red" padding-left>請輸入你的姓名</font>
        </div>

        <div *ngIf="editProfileForm.controls.firstname.hasError('maxlength') && editProfileForm.controls.firstname.touched">
          <font color="red" padding-left>姓名至多10個字</font>
        </div>

      <ion-item>
          <span class="label_padding">性別</span>
          <span *ngIf="userdata[0].gender==1">男</span>
          <span *ngIf="userdata[0].gender==0">女</span>
      </ion-item>

      <ion-item>
          <ion-label primary>學系</ion-label>
          <ion-select formControlName="major_id">
            <ion-option *ngFor="let major of majordatas" value="{{ major.id }}">{{ major.name }}</ion-option>
          </ion-select>
      </ion-item>

      <div *ngIf="editProfileForm.controls.major_id.hasError('required') && editProfileForm.controls.major_id.touched">
          <font color="red" padding-left>請選擇你的學系</font>
      </div>

      <ion-item>
          <span class="label_padding">就讀學校</span>
          <span>{{ college }}</span>
      </ion-item>

        <ion-item>
          <ion-label primary>出生日期</ion-label>
          <ion-datetime displayFormat="MM/DD/YYYY" formControlName="birthday"></ion-datetime>
        </ion-item>

        <div *ngIf="editProfileForm.controls.birthday.hasError('required') && editProfileForm.controls.birthday.touched">
          <font color="red" padding-left>請輸入你的生日</font>
        </div>

        <ion-item>
            <ion-label primary>使用者名稱</ion-label>
            <ion-input type="text" formControlName="username" name="username" disabled='true' *ngIf="userdata[0].username"></ion-input>
            <ion-input type="text" formControlName="username" name="username" *ngIf="!userdata[0].username"></ion-input>
         </ion-item>

          <div *ngIf="!userdata[0].username">
              <font color="red" padding-left>※注意！使用者名稱填寫完後不能再進行修改。</font>
          </div>

          <div *ngIf="editProfileForm.controls.username.hasError('maxlength') && editProfileForm.controls.username.touched">
            <font color="red" padding-left>使用者名稱至多10個字</font>
          </div>

          <div *ngIf="editProfileForm.controls.username.hasError('figureValidator') && editProfileForm.controls.username.touched">
            <font color="red" padding-left>使用者名稱只能由英文或數字組成</font>
          </div>

          <div *ngIf="editProfileForm.controls.username.hasError('notUnique')">
            <font color="red" padding-left>該使用者名稱已經有人使用</font>
          </div>
         <!--<ion-item *ngIf="userdata[0].username">
            <span class="label_padding">使用者名稱</span>
            <span>{{ userdata[0].username }}</span>
         </ion-item>-->
    </ion-list>
        
    <ion-list>
    <ion-list-header>聯絡資訊</ion-list-header>

      <ion-item>
            <ion-label primary>電話</ion-label>
            <ion-input type="text" formControlName="phone" name="phone"></ion-input>
      </ion-item>

      <ion-item>
            <ion-label primary>Line ID</ion-label>
            <ion-input type="text" formControlName="line_username" name="line_username"></ion-input>
      </ion-item>

      <div>
          <font color="red" padding-left>※注意！請將LIne裡面設置允許利用ID加入好友。</font>
      </div>

      <ion-item>
            <ion-label primary>Telegram</ion-label>
            <ion-input type="text" formControlName="telegram_username" name="telegram_username"></ion-input>
      </ion-item>

      <ion-item>
            <ion-label primary>其他電郵</ion-label>
            <ion-input type="text" formControlName="other_email" name="other_email"></ion-input>
      </ion-item>

      <div *ngIf="editProfileForm.controls.other_email.hasError('emailValidator') && editProfileForm.controls.other_email.touched">
            <font color="red" padding-left>其他電郵必須符合email格式</font>
      </div>

    </ion-list>

    </form>

  </div>

</ion-content>


